services:
  web:
    build:
      context: .
      dockerfile: Dockerfile
      target: dev
    ports:
      - "5173:5173"
    volumes:
      # Mount source code for hot reload
      - ./apps:/app/apps
      - ./packages:/app/packages
      - ./content:/app/content
      # Preserve node_modules (don't mount from host)
      - web_node_modules:/app/node_modules
      - web_app_node_modules:/app/apps/web/node_modules
      - ui_node_modules:/app/packages/ui/node_modules
      - content_model_node_modules:/app/packages/content-model/node_modules
      - srs_engine_node_modules:/app/packages/srs-engine/node_modules
      - utils_node_modules:/app/packages/utils/node_modules
    env_file:
      - ./apps/web/.env
    environment:
      - NODE_ENV=development
    stdin_open: true
    tty: true

volumes:
  web_node_modules:
  web_app_node_modules:
  ui_node_modules:
  content_model_node_modules:
  srs_engine_node_modules:
  utils_node_modules:
