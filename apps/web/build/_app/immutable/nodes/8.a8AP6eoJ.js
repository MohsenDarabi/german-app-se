import{s as Z,n as U,d as v,a as Q,i as I,b as o,m as $,l as u,o as ee,g as _,c as d,e as L,p as M,f as R,j as y,h as f,t as X,q as te}from"../chunks/scheduler.-13gY_0V.js";import{S as se,i as le}from"../chunks/index.CL68AUYa.js";import{d as F}from"../chunks/index.lHhEmOCy.js";import{s as ae}from"../chunks/syncEngine.CoSUW4_s.js";import{s as ne}from"../chunks/client.M3ojON4v.js";import{g as J}from"../chunks/entry.Cd0yNLQu.js";function re(i){let t,s='<p class="svelte-1r2c2nc">No local data found. You can still sign in to start using cloud sync for future progress.</p>';return{c(){t=f("div"),t.innerHTML=s,this.h()},l(e){t=d(e,"DIV",{class:!0,"data-svelte-h":!0}),M(t)!=="svelte-cl5r41"&&(t.innerHTML=s),this.h()},h(){u(t,"class","empty-notice svelte-1r2c2nc")},m(e,l){I(e,t,l)},d(e){e&&v(t)}}}function oe(i){let t,s='<h3 class="svelte-1r2c2nc">What will happen:</h3> <ul class="svelte-1r2c2nc"><li class="svelte-1r2c2nc">‚úÖ Your vocabulary and lesson progress will be saved to the cloud</li> <li class="svelte-1r2c2nc">üîÑ Your data will sync across all your devices</li> <li class="svelte-1r2c2nc">üíæ Your local data will be preserved as a backup</li> <li class="svelte-1r2c2nc">üîí Only you can access your data (secured by Google login)</li></ul>';return{c(){t=f("div"),t.innerHTML=s,this.h()},l(e){t=d(e,"DIV",{class:!0,"data-svelte-h":!0}),M(t)!=="svelte-1nctlzc"&&(t.innerHTML=s),this.h()},h(){u(t,"class","info-box svelte-1r2c2nc")},m(e,l){I(e,t,l)},d(e){e&&v(t)}}}function K(i){let t,s;return{c(){t=f("div"),s=X(i[1]),this.h()},l(e){t=d(e,"DIV",{class:!0});var l=L(t);s=R(l,i[1]),l.forEach(v),this.h()},h(){u(t,"class","error-message svelte-1r2c2nc")},m(e,l){I(e,t,l),o(t,s)},p(e,l){l&2&&Q(s,e[1])},d(e){e&&v(t)}}}function ie(i){let t,s,e,l,k="‚òÅÔ∏è",D,c,x="Migrate Your Data",V,b,j="We've added cloud sync! Your progress is currently stored locally on this device.",E,Y,S,h,w=i[0]?"Migrating...":i[2]?"Sign In & Migrate Data":"Sign In to Continue",T,q,p,O="Skip for now",P,C,W=`<strong class="svelte-1r2c2nc">Note:</strong> If you skip this step, your progress will remain local only.
      You can always migrate later by signing in.`,N,z;function A(a,m){return a[2]?oe:re}let H=A(i),g=H(i),n=i[1]&&K(i);return{c(){t=y(),s=f("div"),e=f("div"),l=f("div"),l.textContent=k,D=y(),c=f("h1"),c.textContent=x,V=y(),b=f("p"),b.textContent=j,E=y(),g.c(),Y=y(),n&&n.c(),S=y(),h=f("button"),T=X(w),q=y(),p=f("a"),p.textContent=O,P=y(),C=f("div"),C.innerHTML=W,this.h()},l(a){ee("svelte-1llqn3d",document.head).forEach(v),t=_(a),s=d(a,"DIV",{class:!0});var B=L(s);e=d(B,"DIV",{class:!0});var r=L(e);l=d(r,"DIV",{class:!0,"data-svelte-h":!0}),M(l)!=="svelte-1pxh1x2"&&(l.textContent=k),D=_(r),c=d(r,"H1",{class:!0,"data-svelte-h":!0}),M(c)!=="svelte-doifqq"&&(c.textContent=x),V=_(r),b=d(r,"P",{class:!0,"data-svelte-h":!0}),M(b)!=="svelte-jc3exs"&&(b.textContent=j),E=_(r),g.l(r),Y=_(r),n&&n.l(r),S=_(r),h=d(r,"BUTTON",{class:!0});var G=L(h);T=R(G,w),G.forEach(v),q=_(r),p=d(r,"A",{href:!0,class:!0,"data-svelte-h":!0}),M(p)!=="svelte-1blc2lu"&&(p.textContent=O),P=_(r),C=d(r,"DIV",{class:!0,"data-svelte-h":!0}),M(C)!=="svelte-13xkmg0"&&(C.innerHTML=W),r.forEach(v),B.forEach(v),this.h()},h(){document.title="Migrate Your Data - Deutschlern",u(l,"class","icon svelte-1r2c2nc"),u(c,"class","svelte-1r2c2nc"),u(b,"class","subtitle svelte-1r2c2nc"),u(h,"class","migrate-btn svelte-1r2c2nc"),h.disabled=i[0],u(p,"href","/"),u(p,"class","skip-link svelte-1r2c2nc"),u(C,"class","note svelte-1r2c2nc"),u(e,"class","migrate-card svelte-1r2c2nc"),u(s,"class","migrate-page svelte-1r2c2nc")},m(a,m){I(a,t,m),I(a,s,m),o(s,e),o(e,l),o(e,D),o(e,c),o(e,V),o(e,b),o(e,E),g.m(e,null),o(e,Y),n&&n.m(e,null),o(e,S),o(e,h),o(h,T),o(e,q),o(e,p),o(e,P),o(e,C),N||(z=$(h,"click",i[3]),N=!0)},p(a,[m]){H!==(H=A(a))&&(g.d(1),g=H(a),g&&(g.c(),g.m(e,Y))),a[1]?n?n.p(a,m):(n=K(a),n.c(),n.m(e,S)):n&&(n.d(1),n=null),m&5&&w!==(w=a[0]?"Migrating...":a[2]?"Sign In & Migrate Data":"Sign In to Continue")&&Q(T,w),m&1&&(h.disabled=a[0])},i:U,o:U,d(a){a&&(v(t),v(s)),g.d(),n&&n.d(),N=!1,z()}}}function ce(i,t,s){let e=!1,l=null,k=!1;te(async()=>{const c=await F.vocab.count(),x=await F.lessonProgress.count();s(2,k=c>0||x>0)});async function D(){s(0,e=!0),s(1,l=null);try{const{data:{session:c}}=await ne.auth.getSession();if(!c){J("/auth");return}await ae.sync(),alert("‚úÖ Migration complete! Your data is now synced to the cloud."),J("/")}catch(c){console.error("Migration error:",c),s(1,l=c.message||"Migration failed. Please try again.")}finally{s(0,e=!1)}}return[e,l,k,D]}class pe extends se{constructor(t){super(),le(this,t,ce,ie,Z,{})}}export{pe as component};
